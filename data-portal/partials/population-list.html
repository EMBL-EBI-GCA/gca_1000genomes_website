<div es-search="ListCtrl.searchBody" hits-as="populations" es-type="population" is-loading-as="esPopulationsLoading">
<div class="row data-portal-beta-header">
  <div class="col-lg-6 col-md-5"><h1>Populations</h1></div>
  <div class="col-lg-6 col-md-7"><ul class="nav nav-pills">
    <li><a href="sample"><span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span> Samples home</a></li>
    <li><a href="population"><span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span> Populations home</a></li>
    <li><a href="search"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Search</a></li>
    </ul></div>
</div>
  <div class="clearfix"></div>
  <p ng-if="apiError">{{apiError.status}}: {{apiError.statusText}}</p>
  <div ng-show="populations">

  <div class="form form-inline form-margins">
  <button type="button" class="btn btn-default" ng-click="ListCtrl.toggleAGPanel()">Filter by analysis group <span class="caret"></span></button>
  <button type="button" class="btn btn-default" ng-click="ListCtrl.toggleDCPanel()">Filter by data collection <span class="caret"></span></button>
  <button type="button" class="btn btn-default" ng-click="ListCtrl.toggleView()">Toggle table view</button>
  <button type="button" class="btn btn-default" ng-click="ListCtrl.populationExport()">Download the list</button>
  </div>

  <div class="col-md-8 col-md-offset-2">
  </div>

  <div class="col-md-8 col-md-offset-2">

  <div class="panel panel-default" ng-if="ListCtrl.showAGPanel">
  <div class="panel-heading">Filter by analysis group
  <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="ListCtrl.toggleAGPanel()"><span aria-hidden="true">&times;</span></button>
  </div>
  <div class="panel-body">
    <div class="form form-inline">
      <div class="checkbox checkbox-long" ng-repeat="ag in ListCtrl.analysisGroupNames">
        <label><input type="checkbox" ng-model="ListCtrl.filteredAGs[ag[0]]" ng-change="ListCtrl.search({page: 1})"></input>{{ag[0]}}</label>
      </div>
    </div>
  </div></div>

  <div class="panel panel-default" ng-if="ListCtrl.showDCPanel">
  <div class="panel-heading">Filter by data collection
  <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="ListCtrl.toggleDCPanel()"><span aria-hidden="true">&times;</span></button>
  </div>
  <div class="panel-body">
    <div class="form form-inline">
      <div class="checkbox checkbox-long" ng-repeat="dc in ListCtrl.dataCollectionNames">
        <label><input type="checkbox" ng-model="ListCtrl.filteredDCs[dc[0]]" ng-change="ListCtrl.search({page: 1})"></input>{{dc[0]}}</label>
      </div>
    </div>
  </div></div>

  </div>

  <div class="col-md-10 col-md-offset-1" ng-if="ListCtrl.filteredDCsArray.length || ListCtrl.filteredAGsArray.length"><div class="form form-inline form-margins">
    <div class="form-group"><h3>Filters:</h3></div>
    <button type="button" ng-repeat="dc in ListCtrl.filteredDCsArray" class="btn btn-warning" ng-click="ListCtrl.filteredDCs[dc[0]] = false; ListCtrl.search();">{{dc[1]}} <span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
    <button type="button" ng-repeat="ag in ListCtrl.filteredAGsArray" class="btn btn-info" ng-click="ListCtrl.filteredAGs[ag[0]] = false; ListCtrl.search();">{{ag[1]}} <span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
  </div></div>

  <div class="clearfix"></div>
  <div class="matrix-wrapper">
  <div class="matrix-gap-filler pager-narrow-margins">
  <h4 ng-if="!populations.total">No populations match all filters</h4>
  </div>

  <table class="table table-striped table-condensed matrix" ng-show="!esPopulationsLoading">
  <thead><tr>
    <th>Population</th>
    <th>Description</th>
    <th ng-if="ListCtrl.viewOption == 1" ng-repeat="dcName in ListCtrl.dataCollectionNames" class="matrix-dot"><div>
      <div ng-click="ListCtrl.filteredDCs[dcName[0]] = !ListCtrl.filteredDCs[dcName[0]]; ListCtrl.search({page:1});">
      <div>{{dcName[1]}}</div></div></div></th>
    <th ng-if="ListCtrl.viewOption == 2" ng-repeat="agName in ListCtrl.analysisGroupNames" class="matrix-dot matrix-dot-narrow"><div>
      <div ng-click="ListCtrl.filteredAGs[agName[0]] = !ListCtrl.filteredAGs[agName[0]]; ListCtrl.search({page:1});">
      <div>{{agName[1]}}</div></div></div></th>
  </tr></thead>
  <tr ng-repeat="population in populations.hits">
    <td><a ng-href="population/{{population.fields.code[0]}}">{{population.fields.code[0]}}</a></td>
    <td><a ng-href="population/{{population.fields.code[0]}}">{{population.fields.description[0]}}</a></td>
    <td ng-if="ListCtrl.viewOption == 1" ng-repeat="dcName in ListCtrl.dataCollectionNames" class="matrix-dot">
        <div class="matrix-dot-item matrix-dot-item-gold" ng-if="ListCtrl.hasCollection(population, dcName[0])" uib-popover="{{dcName[0]}}" popover-title="{{population.fields.name[0]}} / {{population.fields.code[0]}}" popover-trigger="mouseenter">&#x25cf;</div>
    </td>
    <td ng-if="ListCtrl.viewOption == 2" ng-repeat="agName in ListCtrl.analysisGroupNames" class="matrix-dot matrix-dot-narrow">
        <div class="matrix-dot-item matrix-dot-item-blue" ng-if="ListCtrl.hasAnalysisGroup(population, agName[0])" uib-popover="{{agName[0]}}" popover-title="{{population.fields.name[0]}} / {{population.fields.code[0]}}" popover-trigger="mouseenter">&#x25cf;</div>
    </td>
  </tr>
  </table>
  </div>

  </div>

</div>
